## 9.1

已总结-大致

操作系统内存使用情况

top输出几个内存数据-物理内存总量，实际分配内存（used,free）

物理内存会被操作系统用于缓存，但是当内存需求大时，撤回缓存，会导致成本上升。

VIRT虚拟内存地址空间，RES实际使用的物理内存，VIRT>RES，大部分虚拟内存并未占用实际内存--page fault机制，结合按需分配内存技术



## 9.2

已总结-大致

中断的硬件部分

中断时硬件发出的请求信号，具有异步性、并发性

PLIC负责处理外设中断的硬件模块。

操作系统可以设置不同设备中断的优先级

## 9.3

已总结-大致

设备驱动概述

驱动的结构-bottom中断处理程序和top应用接口，驱动程序有缓冲队列，从中读取或写入数据。

中断无法访问进程的page table，所以无法操作用户进程的内存，所以bottom只负责设备层面的处理。

设备的编程方式：Memory-mapped I/O

设备的地址映射，主板上每个设备都有固定的物理地址

设备控制寄存器

中断管理，操作系统和设备之间需要明确的通信协议，确保双方的协调与数据传输的正确性。



## 9.4

已总结-大致

在XV6系统启动后，Shell在Console上显示提示符$的原理--shell将字符传输到UART(通用异步发送接收设备)，UART会产生一个中断。

RISC-V的中断相关寄存器

中断设置代码分析-start函数，main函数，plicinit函数，plicinithart函数，scheduler函数



## 9.5



## 9.6



## 9.7



## 9.8



## 9.9